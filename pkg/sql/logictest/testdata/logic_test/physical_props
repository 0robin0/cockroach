# LogicTest: default

statement ok
CREATE TABLE abcd (a INT PRIMARY KEY, b INT, c INT, d INT)

query ITTTTT colnames
EXPLAIN (VERBOSE) SELECT * FROM abcd WHERE b = c
----
Level  Type  Field   Description   Columns       Ordering
0      scan  ·       ·             (a, b, c, d)  b=c; key(a)
0      ·     table   abcd@primary  ·             ·
0      ·     spans   ALL           ·             ·
0      ·     filter  b = c         ·             ·

query ITTTTT colnames
EXPLAIN (VERBOSE) SELECT * FROM abcd WHERE a = 1
----
Level  Type  Field  Description   Columns       Ordering
0      scan  ·      ·             (a, b, c, d)  a=CONST; key()
0      ·     table  abcd@primary  ·             ·
0      ·     spans  /1-/2         ·             ·

query ITTTTT colnames
EXPLAIN (VERBOSE) SELECT * FROM abcd WHERE b = 1
----
Level  Type  Field   Description   Columns       Ordering
0      scan  ·       ·             (a, b, c, d)  b=CONST; key(a)
0      ·     table   abcd@primary  ·             ·
0      ·     spans   ALL           ·             ·
0      ·     filter  b = 1         ·             ·

query ITTTTT colnames
EXPLAIN (VERBOSE) SELECT * FROM abcd WHERE a = 1 AND b = 1
----
Level  Type  Field   Description   Columns       Ordering
0      scan  ·       ·             (a, b, c, d)  a=CONST; b=CONST; key()
0      ·     table   abcd@primary  ·             ·
0      ·     spans   /1-/2         ·             ·
0      ·     filter  b = 1         ·             ·

query ITTTTT colnames
EXPLAIN (VERBOSE) SELECT * FROM abcd WHERE a = 1 AND b = d
----
Level  Type  Field   Description   Columns       Ordering
0      scan  ·       ·             (a, b, c, d)  b=d; a=CONST; key()
0      ·     table   abcd@primary  ·             ·
0      ·     spans   /1-/2         ·             ·
0      ·     filter  b = d         ·             ·

query ITTTTT colnames
EXPLAIN (VERBOSE) SELECT * FROM abcd WHERE a = b AND b = c
----
Level  Type  Field   Description          Columns       Ordering
0      scan  ·       ·                    (a, b, c, d)  a=b=c; key(a)
0      ·     table   abcd@primary         ·             ·
0      ·     spans   ALL                  ·             ·
0      ·     filter  (a = b) AND (b = c)  ·             ·

query ITTTTT colnames
EXPLAIN (VERBOSE) SELECT * FROM abcd WHERE a = b AND b = c AND c = 1
----
Level  Type  Field   Description                        Columns       Ordering
0      scan  ·       ·                                  (a, b, c, d)  a=b=c; a=CONST; key()
0      ·     table   abcd@primary                       ·             ·
0      ·     spans   ALL                                ·             ·
0      ·     filter  ((a = b) AND (b = c)) AND (c = 1)  ·             ·

statement ok
CREATE TABLE efg (e INT PRIMARY KEY, f INT, g INT)

query ITTTTT colnames
EXPLAIN (VERBOSE) SELECT * FROM abcd JOIN efg ON a=e AND a=1 AND f=g
----
Level  Type  Field           Description   Columns                Ordering
0      join  ·               ·             (a, b, c, d, e, f, g)  a=e; f=g; a=CONST
0      ·     type            inner         ·                      ·
0      ·     equality        (a) = (e)     ·                      ·
0      ·     mergeJoinOrder  +"(a=e)"      ·                      ·
1      scan  ·               ·             (a, b, c, d)           a=CONST; key()
1      ·     table           abcd@primary  ·                      ·
1      ·     spans           /1-/2         ·                      ·
1      scan  ·               ·             (e, f, g)              f=g; key(e); +e
1      ·     table           efg@primary   ·                      ·
1      ·     spans           ALL           ·                      ·
1      ·     filter          f = g         ·                      ·
